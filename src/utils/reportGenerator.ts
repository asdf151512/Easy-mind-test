// 分類別心理測驗報告生成器

export function generateCategoryReport(category: string, percentage: number): string {
  const categoryNames: { [key: string]: string } = {
    'family': '家庭',
    'relationship': '感情關係',
    'work': '工作',
    'personal': '個人思維',
    'all': '綜合'
  };

  const categoryName = categoryNames[category] || '綜合';

  switch (category) {
    case 'family':
      return generateFamilyReport(percentage);
    case 'relationship':
      return generateRelationshipReport(percentage);
    case 'work':
      return generateWorkReport(percentage);
    case 'personal':
      return generatePersonalReport(percentage);
    case 'all':
      return generateComprehensiveReport(percentage);
    default:
      return generateComprehensiveReport(percentage);
  }
}

function generateFamilyReport(percentage: number): string {
  const baseAnalysis = getAnalysisLevel(percentage);

  return `
<h3>家庭關係詳細分析報告</h3>

<h4>家庭互動模式評估</h4>
<p>根據您的測驗結果，您在家庭關係方面的整體表現為${baseAnalysis.level}。${baseAnalysis.description}</p>

<h4>家庭溝通能力</h4>
${percentage >= 70 ?
  '<p>您在家庭溝通方面表現優秀，能夠有效表達自己的想法，同時也善於傾聽家人的意見。您具備良好的情緒管理能力，在家庭衝突中能夠保持冷靜並尋求解決方案。</p>' :
  '<p>在家庭溝通方面，您可能需要加強表達技巧和傾聽能力。建議在與家人交流時，多使用「我」的表達方式，避免指責性的語言，同時給予家人充分的表達機會。</p>'
}

<h4>家庭責任與角色</h4>
${percentage >= 60 ?
  '<p>您對家庭責任有清晰的認知，能夠在家庭中承擔適當的角色。您願意為家庭付出，也能在需要時尋求其他家庭成員的協助。</p>' :
  '<p>建議您重新檢視自己在家庭中的角色定位，思考如何在承擔責任和保持個人空間之間找到平衡。與家人開放地討論責任分工，可能會有助於改善家庭動力。</p>'
}

<h4>親子關係建議</h4>
<p>無論您是父母還是子女，良好的親子關係都建立在相互尊重和理解的基礎上。建議：</p>
<ul>
<li>定期安排家庭時光，增進彼此了解</li>
<li>尊重不同世代的價值觀和生活方式</li>
<li>在衝突中尋找共同點，而非強調差異</li>
<li>學習表達愛意和感謝，增強家庭凝聚力</li>
</ul>

<h4>家庭壓力管理</h4>
${percentage >= 70 ?
  '<p>您具備良好的家庭壓力管理能力，能夠在家庭壓力中保持穩定。繼續保持這種積極的態度，並在必要時尋求外部支持。</p>' :
  '<p>家庭壓力可能對您造成一定影響。建議學習壓力釋放技巧，如深呼吸、運動或尋求專業家庭諮詢。記住，尋求幫助是智慧的表現，不是軟弱。</p>'
}

<h4>長期家庭關係發展</h4>
<p>家庭關係需要持續的經營和投入。建議定期與家人進行深度交流，了解彼此的需求和期望變化，共同建立和諧的家庭環境。</p>

<p><strong>專業建議：</strong>如果家庭關係持續緊張或出現嚴重衝突，建議考慮家庭諮詢服務，專業的家庭治療師能夠幫助改善家庭動力。</p>
  `;
}

function generateRelationshipReport(percentage: number): string {
  const baseAnalysis = getAnalysisLevel(percentage);

  return `
<h3>感情關係詳細分析報告</h3>

<h4>感情能力整體評估</h4>
<p>您在感情關係方面的整體表現為${baseAnalysis.level}。${baseAnalysis.description}</p>

<h4>情感表達與溝通</h4>
${percentage >= 70 ?
  '<p>您在感情表達方面表現出色，能夠真誠地向伴侶表達自己的感受和需求。您具備良好的情感智慧，能夠理解並回應伴侶的情感狀態。</p>' :
  '<p>在情感表達方面，您可能需要更多練習。建議學習如何清晰地表達內心感受，避免假設對方能夠讀懂您的心思。定期與伴侶進行深度對話，分享彼此的想法和感受。</p>'
}

<h4>親密關係建立</h4>
${percentage >= 60 ?
  '<p>您具備建立深度親密關係的能力，能夠在維持個人獨立性的同時與伴侶建立親密連結。您理解親密關係需要時間和努力來培養。</p>' :
  '<p>建立親密關係可能對您來說是個挑戰。記住，真正的親密來自於脆弱性的分享和相互接納。嘗試逐步開放自己，與伴侶分享更深層的想法和感受。</p>'
}

<h4>衝突處理能力</h4>
${percentage >= 65 ?
  '<p>您在處理感情衝突方面表現良好，能夠以建設性的方式解決分歧。您明白衝突是關係中正常的一部分，重要的是如何處理它們。</p>' :
  '<p>在處理感情衝突時，您可能需要學習更有效的技巧。建議採用「暫停-反思-回應」的模式，避免在情緒激動時做出傷害性的言論。學習主動傾聽和同理心表達。</p>'
}

<h4>信任與忠誠</h4>
<p>信任是感情關係的基石。建議：</p>
<ul>
<li>保持開放和誠實的溝通</li>
<li>遵守對伴侶的承諾</li>
<li>在困難時期給予彼此支持</li>
<li>尊重伴侶的個人空間和隱私</li>
<li>建立共同的價值觀和未來願景</li>
</ul>

<h4>感情成長與發展</h4>
${percentage >= 70 ?
  '<p>您具備與伴侶共同成長的能力，能夠在關係中保持個人發展的同時促進雙方的成長。繼續培養這種平衡的關係模式。</p>' :
  '<p>感情關係需要雙方的共同努力和成長。建議設定共同目標，支持彼此的個人發展，同時投資於關係的深化和改善。</p>'
}

<h4>長期關係維護</h4>
<p>長期穩定的感情關係需要持續的投入和經營。定期檢視關係狀態，保持新鮮感，共同面對生活挑戰，是維護感情的關鍵要素。</p>

<p><strong>專業建議：</strong>如果感情關係出現嚴重問題，建議尋求伴侶諮詢服務。專業的關係治療師能夠幫助您們改善溝通模式並重建親密連結。</p>
  `;
}

function generateWorkReport(percentage: number): string {
  const baseAnalysis = getAnalysisLevel(percentage);

  return `
<h3>工作心理詳細分析報告</h3>

<h4>工作心理狀態評估</h4>
<p>您在工作相關心理狀態方面的整體表現為${baseAnalysis.level}。${baseAnalysis.description}</p>

<h4>工作壓力管理</h4>
${percentage >= 70 ?
  '<p>您具備優秀的工作壓力管理能力，能夠在高壓環境中保持冷靜和效率。您懂得如何平衡工作要求和個人能力，適當地設定界限。</p>' :
  '<p>工作壓力管理是您需要加強的領域。建議學習壓力識別技巧，建立有效的壓力釋放方式，如定期休息、運動或冥想。記住，適度的壓力有助於提高表現，但過度壓力會影響健康和效率。</p>'
}

<h4>職場人際關係</h4>
${percentage >= 60 ?
  '<p>您在職場人際關係方面表現良好，能夠與同事建立正面的工作關係。您具備團隊合作精神，同時也能保持專業界限。</p>' :
  '<p>改善職場人際關係可能有助於您的工作表現和職業發展。建議主動與同事交流，參與團隊活動，學習有效的職場溝通技巧，建立互信互助的工作環境。</p>'
}

<h4>工作動機與成就感</h4>
${percentage >= 65 ?
  '<p>您對工作具有明確的動機和目標，能夠從工作成就中獲得滿足感。您理解工作的意義不僅在於薪酬，更在於個人成長和價值實現。</p>' :
  '<p>重新審視您的工作動機可能有所幫助。思考什麼樣的工作內容能夠激發您的熱情，設定具體可達成的職業目標，尋找工作中的成長機會和意義。</p>'
}

<h4>工作生活平衡</h4>
<p>健康的工作生活平衡對於長期職業發展至關重要：</p>
<ul>
<li>設定明確的工作時間界限</li>
<li>培養工作以外的興趣和社交活動</li>
<li>定期評估工作負荷，適時調整</li>
<li>重視家庭時間和個人健康</li>
<li>學習說「不」，避免過度承諾</li>
</ul>

<h4>職業發展規劃</h4>
${percentage >= 70 ?
  '<p>您對職業發展有清晰的認知和規劃。繼續保持學習的態度，尋求新的挑戰和成長機會，建立有價值的職業網絡。</p>' :
  '<p>建議制定具體的職業發展計劃，識別所需技能和知識，尋求指導者或職業顧問的建議。持續學習和自我提升是職業成功的關鍵。</p>'
}

<h4>職場適應與變化應對</h4>
${percentage >= 60 ?
  '<p>您具備良好的職場適應能力，能夠應對工作環境的變化和挑戰。保持這種靈活性和開放態度，它們是現代職場的重要能力。</p>' :
  '<p>提高職場適應能力有助於您的職業發展。建議培養成長思維，將變化視為學習機會，建立強韌性來應對職場挑戰。</p>'
}

<p><strong>專業建議：</strong>如果工作壓力嚴重影響您的身心健康，建議尋求職業諮詢或心理健康專業服務。良好的心理狀態是職業成功的基礎。</p>
  `;
}

function generatePersonalReport(percentage: number): string {
  const baseAnalysis = getAnalysisLevel(percentage);

  return `
<h3>個人思維模式詳細分析報告</h3>

<h4>思維模式整體評估</h4>
<p>您在個人思維發展方面的整體表現為${baseAnalysis.level}。${baseAnalysis.description}</p>

<h4>自我認知能力</h4>
${percentage >= 70 ?
  '<p>您具備優秀的自我認知能力，能夠清楚了解自己的優勢、弱點、價值觀和動機。這種自我覺察是個人成長和良好決策的基礎。</p>' :
  '<p>提高自我認知能力將有助於您的個人發展。建議定期進行自我反思，記錄思考和感受，尋求他人的回饋，參與自我探索的活動或課程。</p>'
}

<h4>情緒智慧與管理</h4>
${percentage >= 65 ?
  '<p>您在情緒管理方面表現良好，能夠識別、理解和有效調節自己的情緒。您也具備同理心，能夠理解他人的情緒狀態。</p>' :
  '<p>發展情緒智慧對於個人和人際關係都非常重要。建議學習情緒識別技巧，練習情緒調節方法，如深呼吸、正念冥想或情緒日記。</p>'
}

<h4>價值觀與人生目標</h4>
${percentage >= 60 ?
  '<p>您對自己的核心價值觀有較清晰的認知，能夠依據價值觀做出人生選擇。您的人生目標相對明確，並願意為實現目標而努力。</p>' :
  '<p>明確的價值觀和目標是人生導航的重要工具。建議花時間思考什麼對您最重要，設定符合價值觀的具體目標，並制定實現計劃。</p>'
}

<h4>學習與成長思維</h4>
<p>培養成長思維對於終身發展至關重要：</p>
<ul>
<li>將挑戰視為學習機會而非威脅</li>
<li>從失敗中汲取教訓，不斷改進</li>
<li>保持好奇心和開放態度</li>
<li>主動尋求新的學習經驗</li>
<li>相信努力和練習能夠提高能力</li>
</ul>

<h4>決策與問題解決</h4>
${percentage >= 70 ?
  '<p>您具備良好的決策和問題解決能力，能夠理性分析情況，考慮多種選擇，並做出明智的決定。您也能從決策結果中學習和調整。</p>' :
  '<p>提高決策能力有助於人生的各個領域。建議學習系統性的決策方法，收集充分資訊，考慮長期後果，並培養從決策結果中學習的習慣。</p>'
}

<h4>心理韌性建設</h4>
${percentage >= 65 ?
  '<p>您展現出良好的心理韌性，能夠在困難和挫折中保持堅強，並從逆境中恢復。這是應對人生挑戰的重要能力。</p>' :
  '<p>建設心理韌性需要時間和練習。建議培養積極的思維模式，建立支持網絡，學習壓力管理技巧，保持身心健康的生活方式。</p>'
}

<h4>人生意義與目的</h4>
${percentage >= 60 ?
  '<p>您對人生意義有一定的思考和理解，能夠找到生活的目的和方向。這種意義感為您提供動力和指引。</p>' :
  '<p>探索人生意義是一個持續的過程。建議思考什麼給您的生活帶來滿足感，如何為他人和社會做出貢獻，以及如何實現個人價值。</p>'
}

<p><strong>專業建議：</strong>個人思維發展是終身的課程。如果您希望更深入地探索自我，建議考慮心理諮詢、個人教練或參與個人成長課程。</p>
  `;
}

function generateComprehensiveReport(percentage: number): string {
  const baseAnalysis = getAnalysisLevel(percentage);

  return `
<h3>綜合心理狀態詳細分析報告</h3>

<h4>整體心理健康評估</h4>
<p>您的綜合心理狀態表現為${baseAnalysis.level}。${baseAnalysis.description}這份評估涵蓋了您在家庭、感情、工作和個人思維等多個生活領域的表現。</p>

<h4>生活領域平衡分析</h4>
${percentage >= 70 ?
  '<p>您在各個生活領域都展現出良好的平衡和適應能力。您能夠有效地協調不同生活角色的需求，保持整體的心理健康和生活滿意度。</p>' :
  '<p>生活各領域的平衡是心理健康的重要指標。建議檢視您在家庭、工作、人際關係和個人發展方面的投入，尋找可能失衡的地方並進行調整。</p>'
}

<h4>壓力管理與適應能力</h4>
${percentage >= 65 ?
  '<p>您具備良好的壓力管理和適應能力，能夠在面對生活挑戰時保持穩定的心理狀態。您懂得如何尋求資源和支持來應對困難。</p>' :
  '<p>提高壓力管理能力對於整體心理健康至關重要。建議學習多種壓力釋放技巧，建立支持網絡，培養解決問題的技能，並保持健康的生活方式。</p>'
}

<h4>人際關係綜合表現</h4>
${percentage >= 60 ?
  '<p>您在人際關係方面表現穩定，能夠在不同的社交環境中建立和維護良好的關係。您具備同理心和溝通技巧，能夠理解和支持他人。</p>' :
  '<p>改善人際關係技巧將有助於您在生活的各個領域。建議練習主動傾聽，學習表達同理心，培養衝突解決技巧，並投資於有意義的關係建設。</p>'
}

<h4>個人成長與發展潛力</h4>
<p>持續的個人成長是心理健康的重要組成部分：</p>
<ul>
<li>設定個人發展目標，涵蓋各個生活領域</li>
<li>培養終身學習的態度和習慣</li>
<li>尋求新的挑戰和成長機會</li>
<li>建立自我反思和評估的習慣</li>
<li>保持對新經驗的開放態度</li>
</ul>

<h4>情緒健康與幸福感</h4>
${percentage >= 70 ?
  '<p>您具備良好的情緒健康狀態，能夠體驗積極情緒並有效管理負面情緒。您的生活滿意度較高，具備創造幸福的能力。</p>' :
  '<p>提升情緒健康和幸福感需要多方面的努力。建議培養感恩習慣，參與有意義的活動，建立正面的社交關係，並學習情緒調節技巧。</p>'
}

<h4>未來發展方向建議</h4>
${percentage >= 65 ?
  '<p>基於您的測驗結果，建議繼續保持當前的積極狀態，同時關注個人成長的新領域。考慮挑戰自己，拓展舒適圈，追求更高層次的個人實現。</p>' :
  '<p>建議制定全面的個人發展計劃，包括心理健康維護、技能提升、關係改善和生活品質提升等方面。設定具體、可衡量的目標，並定期檢視進展。</p>'
}

<h4>長期心理健康維護策略</h4>
<p>維護長期心理健康需要持續的關注和投入：</p>
<ul>
<li>建立規律的自我檢視習慣</li>
<li>保持身心健康的生活方式</li>
<li>培養支持性的社交網絡</li>
<li>學習應對變化和挑戰的技能</li>
<li>在需要時尋求專業幫助</li>
</ul>

<p><strong>專業建議：</strong>這份綜合評估為您提供了全面的心理狀態概覽。如果您希望在特定領域獲得更深入的指導，建議尋求相關專業服務，如心理諮詢、職業指導或關係諮詢等。記住，投資於心理健康是投資於更好的生活品質。</p>
  `;
}

function getAnalysisLevel(percentage: number): { level: string; description: string } {
  if (percentage >= 80) {
    return {
      level: "優秀水準",
      description: "您在此領域展現出卓越的能力和積極的態度，能夠有效應對各種挑戰並保持良好的狀態。"
    };
  } else if (percentage >= 65) {
    return {
      level: "良好水準",
      description: "您在此領域表現良好，具備穩定的能力和正面的態度，在某些方面還有進一步提升的空間。"
    };
  } else if (percentage >= 50) {
    return {
      level: "中等水準",
      description: "您在此領域的表現處於平均水準，有一定的基礎能力，但需要加強和改善以達到更好的狀態。"
    };
  } else if (percentage >= 35) {
    return {
      level: "需要關注",
      description: "您在此領域可能面臨一些挑戰，建議積極尋求改善方法和支持資源。"
    };
  } else {
    return {
      level: "建議專業協助",
      description: "您在此領域可能需要專業的指導和支持來改善現狀，建議考慮尋求相關的專業服務。"
    };
  }
}